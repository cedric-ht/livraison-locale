<!DOCTYPE html>

<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Terroir Sables - Livraison Express</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,600;0,700;1,400;1,600&family=DM+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
:root {
  --bordeaux:  #5C1A2E;
  --bordeaux2: #7A2D45;
  --bordeaux3: #9E4A62;
  --creme:     #F7F2E8;
  --creme2:    #EDE7D6;
  --creme3:    #DDD4BE;
  --vert:      #6B8F5E;
  --vert2:     #8BAF7C;
  --or:        #C4963A;
  --texte:     #1E1410;
  --texte2:    #5C4A3A;
  --blanc:     #FEFCF8;
  --shadow-sm: 0 2px 12px rgba(92,26,46,0.08);
  --shadow-md: 0 8px 32px rgba(92,26,46,0.12);
  --shadow-lg: 0 20px 60px rgba(92,26,46,0.18);
  --radius:    20px;
  --radius-sm: 12px;
}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'DM Sans',sans-serif;background:var(--creme);color:var(--texte);min-height:100vh;overflow-x:hidden}
h1,h2,h3,h4{font-family:'Cormorant Garamond',serif;color:var(--texte)}

/* HEADER */
header{background:var(â€“bordeaux);background-image:radial-gradient(ellipse at 20% 50%,rgba(196,150,58,0.12) 0%,transparent 60%),radial-gradient(ellipse at 80% 20%,rgba(255,255,255,0.05) 0%,transparent 50%);color:white;padding:2rem 1.5rem 2.5rem;position:relative;overflow:hidden}
header::after{content:â€™â€™;position:absolute;bottom:0;left:0;right:0;height:3px;background:linear-gradient(90deg,transparent,var(â€“or),transparent)}
.header-top{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:1.5rem}
.header-brand h1{font-family:â€˜Cormorant Garamondâ€™,serif;font-size:2rem;font-weight:700;color:white;letter-spacing:0.5px;line-height:1.1}
.header-brand .subtitle{font-size:0.78rem;color:rgba(255,255,255,0.6);font-weight:300;letter-spacing:2px;text-transform:uppercase;margin-top:0.2rem}
.header-badge{background:rgba(196,150,58,0.2);border:1px solid rgba(196,150,58,0.4);border-radius:30px;padding:0.35rem 0.9rem;font-size:0.78rem;color:#D4A850;font-weight:500;white-space:nowrap}
.header-tagline{font-family:â€˜Cormorant Garamondâ€™,serif;font-style:italic;font-size:1.15rem;color:rgba(255,255,255,0.85);margin-bottom:1.5rem;line-height:1.4}
#cta{display:flex;gap:0.8rem}
#orderBtn{flex:2;padding:0.95rem 1.2rem;border:none;border-radius:var(â€“radius-sm);background:var(â€“or);color:white;font-family:â€˜DM Sansâ€™,sans-serif;font-weight:600;font-size:0.95rem;cursor:pointer;transition:all 0.25s ease}
#orderBtn:hover{background:#D4A850;transform:translateY(-2px);box-shadow:0 8px 24px rgba(196,150,58,0.4)}
#menuBtn{flex:1;padding:0.95rem;border:1.5px solid rgba(255,255,255,0.25);border-radius:var(â€“radius-sm);background:transparent;color:white;font-family:â€˜DM Sansâ€™,sans-serif;font-weight:500;font-size:0.95rem;cursor:pointer;transition:all 0.25s ease}
#menuBtn:hover{background:rgba(255,255,255,0.12)}

/* MENU */
#mobileMenuOverlay{display:none;position:fixed;inset:0;background:rgba(30,20,16,0.6);z-index:998;backdrop-filter:blur(4px)}
#mobileMenu{display:none;position:fixed;top:0;right:0;bottom:0;width:min(320px,85vw);background:var(â€“blanc);z-index:999;padding:3rem 2rem;box-shadow:-20px 0 60px rgba(92,26,46,0.2);overflow-y:auto}
.menu-header{font-family:â€˜Cormorant Garamondâ€™,serif;font-size:1.5rem;color:var(â€“bordeaux);margin-bottom:2rem;padding-bottom:1rem;border-bottom:1px solid var(â€“creme2)}
#mobileMenu a{display:flex;align-items:center;gap:0.8rem;padding:1rem 0;font-size:1rem;font-weight:500;color:var(â€“texte);border-bottom:1px solid var(â€“creme2);cursor:pointer;transition:color 0.2s;text-decoration:none}
#mobileMenu a:hover{color:var(â€“bordeaux)}
.menu-icon{width:32px;height:32px;border-radius:8px;background:var(â€“creme2);display:flex;align-items:center;justify-content:center;font-size:1rem}

/* AUTH */
#authBox{display:none;max-width:420px;margin:2rem auto;padding:2.5rem;background:var(â€“blanc);border-radius:var(â€“radius);box-shadow:var(â€“shadow-lg);border:1px solid var(â€“creme2)}
#authBox h3{font-size:1.8rem;color:var(â€“bordeaux);margin-bottom:0.4rem;text-align:center}
.auth-sub{text-align:center;color:var(â€“texte2);font-size:0.88rem;margin-bottom:1.8rem}
#authBox input{width:100%;padding:0.9rem 1.1rem;margin-bottom:1rem;border-radius:var(â€“radius-sm);border:1.5px solid var(â€“creme3);font-family:â€˜DM Sansâ€™,sans-serif;font-size:0.95rem;background:var(â€“creme);color:var(â€“texte);transition:border 0.2s}
#authBox input:focus{outline:none;border-color:var(â€“bordeaux2)}
.auth-btn-primary{width:100%;padding:1rem;border:none;border-radius:var(â€“radius-sm);background:var(â€“bordeaux);color:white;font-family:â€˜DM Sansâ€™,sans-serif;font-weight:600;font-size:1rem;cursor:pointer;transition:all 0.25s;margin-bottom:0.8rem}
.auth-btn-primary:hover{background:var(â€“bordeaux2);transform:translateY(-2px)}
.auth-btn-secondary{width:100%;padding:1rem;border:1.5px solid var(â€“creme3);border-radius:var(â€“radius-sm);background:transparent;color:var(â€“texte2);font-family:â€˜DM Sansâ€™,sans-serif;font-weight:500;font-size:1rem;cursor:pointer;transition:all 0.25s}
.auth-btn-secondary:hover{border-color:var(â€“bordeaux2);color:var(â€“bordeaux)}

/* SECTIONS */
section{padding:1.5rem 1.2rem;max-width:1000px;margin:auto}

/* ACCUEIL */
.accueil-hero{background:var(â€“blanc);border-radius:var(â€“radius);padding:2.5rem 2rem;margin-bottom:1.5rem;border:1px solid var(â€“creme2);box-shadow:var(â€“shadow-sm);position:relative;overflow:hidden}
.accueil-hero::before{content:â€˜ğŸ·â€™;position:absolute;right:-10px;top:-10px;font-size:8rem;opacity:0.04;transform:rotate(15deg)}
.accueil-hero h2{font-size:2.2rem;color:var(â€“bordeaux);margin-bottom:0.8rem;line-height:1.2}
.accueil-hero p{color:var(â€“texte2);font-size:1rem;line-height:1.7;margin-bottom:1.5rem}
.accueil-features{display:grid;grid-template-columns:repeat(3,1fr);gap:1rem}
.feature-card{background:var(â€“creme);border-radius:var(â€“radius-sm);padding:1.2rem;text-align:center;border:1px solid var(â€“creme2)}
.feature-icon{font-size:1.5rem;margin-bottom:0.4rem}
.feature-card h4{font-family:â€˜DM Sansâ€™,sans-serif;font-size:0.82rem;font-weight:600;color:var(â€“texte);margin-bottom:0.2rem}
.feature-card p{font-size:0.75rem;color:var(â€“texte2);line-height:1.4}

/* ZONE BANNER */
.zone-banner{background:linear-gradient(135deg,var(â€“vert),var(â€“vert2));border-radius:var(â€“radius-sm);padding:1rem 1.3rem;margin-bottom:1.5rem;display:flex;align-items:center;gap:1rem;box-shadow:0 4px 16px rgba(107,143,94,0.25)}
.zone-banner-icon{font-size:1.4rem}
.zone-banner-text{flex:1;font-size:0.88rem;color:white;line-height:1.5}
.zone-banner-text strong{font-weight:600}
.section-label{font-family:â€˜DM Sansâ€™,sans-serif;font-size:0.75rem;font-weight:600;color:var(â€“texte2);letter-spacing:2px;text-transform:uppercase;margin-bottom:1rem;display:flex;align-items:center;gap:0.5rem}
.section-label::after{content:â€™â€™;flex:1;height:1px;background:var(â€“creme3)}

/* GRIDS */
#categoryList,#commerceList,#productList{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:1.2rem;margin-bottom:1.5rem}

/* CATEGORY */
.category{background:var(â€“blanc);padding:1.4rem 1.6rem;border-radius:var(â€“radius);border:1.5px solid var(â€“creme2);box-shadow:var(â€“shadow-sm);cursor:pointer;transition:all 0.25s;display:flex;align-items:center;justify-content:space-between;font-family:â€˜Cormorant Garamondâ€™,serif;font-size:1.3rem;font-weight:600;color:var(â€“texte)}
.category:hover{transform:translateY(-3px);box-shadow:var(â€“shadow-md);border-color:var(â€“bordeaux3)}
.category.selected{background:var(â€“bordeaux);border-color:var(â€“bordeaux);color:white}
.cat-arrow{color:var(â€“texte2);transition:transform 0.2s;font-size:0.85rem}
.category.selected .cat-arrow{transform:rotate(90deg);color:rgba(255,255,255,0.7)}

/* COMMERCE */
.commerce{background:var(â€“blanc);padding:1.3rem 1.5rem;border-radius:var(â€“radius);border:1.5px solid var(â€“creme2);box-shadow:var(â€“shadow-sm);cursor:pointer;transition:all 0.25s;display:flex;align-items:center;justify-content:space-between}
.commerce:hover{transform:translateY(-3px);box-shadow:var(â€“shadow-md);border-color:var(â€“vert2)}
.commerce.selected{border-color:var(â€“vert);background:rgba(107,143,94,0.06)}
.commerce-name{font-family:â€˜Cormorant Garamondâ€™,serif;font-size:1.2rem;font-weight:600;color:var(â€“texte)}
.commerce-tag{font-size:0.75rem;color:var(â€“texte2);margin-top:0.2rem}

/* PRODUIT */
.product{background:var(â€“blanc);border-radius:var(â€“radius);border:1.5px solid var(â€“creme2);box-shadow:var(â€“shadow-sm);overflow:hidden;transition:all 0.25s;display:flex;flex-direction:column}
.product:hover{transform:translateY(-4px);box-shadow:var(â€“shadow-md);border-color:var(â€“bordeaux3)}
.productImg{width:100%;height:170px;object-fit:cover}
.product-body{padding:1.2rem;flex:1;display:flex;flex-direction:column}
.product-name{font-family:â€˜Cormorant Garamondâ€™,serif;font-size:1.25rem;font-weight:600;color:var(â€“texte);margin-bottom:0.3rem}
.product-description{font-size:0.83rem;color:var(â€“texte2);font-style:italic;line-height:1.5;margin-bottom:0.8rem;flex:1}
.product-footer{display:flex;align-items:center;justify-content:space-between;margin-bottom:1rem}
.product-price{font-family:â€˜Cormorant Garamondâ€™,serif;font-size:1.5rem;font-weight:700;color:var(â€“bordeaux)}
.product-price span{font-size:0.85rem;font-weight:400;color:var(â€“texte2);font-family:â€˜DM Sansâ€™,sans-serif}
.stock-badge{font-size:0.75rem;color:var(â€“texte2);background:var(â€“creme);padding:0.2rem 0.7rem;border-radius:20px;border:1px solid var(â€“creme3)}
.max-badge{display:inline-block;font-size:0.72rem;color:var(â€“vert);background:rgba(107,143,94,0.1);border:1px solid rgba(107,143,94,0.3);border-radius:20px;padding:0.15rem 0.6rem;margin-bottom:0.8rem;font-weight:500}
.add-btn{margin:0 1.2rem 1.2rem;padding:0.85rem;border:none;border-radius:var(â€“radius-sm);background:var(â€“bordeaux);color:white;font-family:â€˜DM Sansâ€™,sans-serif;font-weight:600;font-size:0.9rem;cursor:pointer;transition:all 0.25s;letter-spacing:0.3px}
.add-btn:hover:not(:disabled){background:var(â€“bordeaux2);transform:translateY(-1px);box-shadow:0 6px 20px rgba(92,26,46,0.25)}
.add-btn:disabled{background:var(â€“creme3);color:var(â€“texte2);cursor:not-allowed;transform:none}

/* MES COMMANDES */
.order-card{background:var(â€“blanc);border-radius:var(â€“radius);border:1.5px solid var(â€“creme2);box-shadow:var(â€“shadow-sm);padding:1.5rem;margin-bottom:1.2rem}
.order-card-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}
.order-card-title{font-family:â€˜Cormorant Garamondâ€™,serif;font-size:1.3rem;color:var(â€“bordeaux)}
.order-date{font-size:0.8rem;color:var(â€“texte2)}
.order-total-display{font-weight:600;color:var(â€“texte);margin-bottom:0.8rem}
.status-bar{display:flex;gap:6px;margin:0.8rem 0}
.status-step{flex:1;height:6px;border-radius:6px;background:var(â€“creme3);transition:background 0.3s}
.status-step.active{background:var(â€“vert)}
.status-label{font-size:0.8rem;color:var(â€“texte2)}

/* PANIER */
#cart{position:fixed;bottom:1.2rem;left:1.2rem;right:1.2rem;z-index:500;background:var(â€“blanc);border-radius:var(â€“radius);padding:1.1rem 1.4rem;box-shadow:var(â€“shadow-lg);border:1.5px solid var(â€“creme2)}
#cartHeader{display:flex;justify-content:space-between;align-items:center;cursor:pointer}
.cart-title{font-family:â€˜Cormorant Garamondâ€™,serif;font-size:1.2rem;color:var(â€“bordeaux);font-weight:700;display:flex;align-items:center;gap:0.5rem}
.cart-count{background:var(â€“bordeaux);color:white;font-family:â€˜DM Sansâ€™,sans-serif;font-size:0.72rem;font-weight:600;padding:0.15rem 0.5rem;border-radius:20px}
.cart-toggle{color:var(â€“texte2);font-size:0.8rem;transition:transform 0.2s}
#cartContent{max-height:40vh;overflow-y:auto;margin-top:1rem;display:none}
#cart.expanded #cartContent,#cart.expanded .cart-actions{display:block}
.cart-item{display:flex;align-items:center;justify-content:space-between;padding:0.7rem 0;border-bottom:1px solid var(â€“creme2)}
.cart-item-info{flex:1}
.cart-item-name{font-weight:500;font-size:0.9rem;color:var(â€“texte)}
.cart-item-price{font-size:0.82rem;color:var(â€“texte2)}
.cart-item-controls{display:flex;align-items:center;gap:0.5rem}
.qty-btn{width:28px;height:28px;border:1.5px solid var(â€“creme3);border-radius:8px;background:var(â€“creme);color:var(â€“texte);font-size:1rem;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all 0.15s;font-family:â€˜DM Sansâ€™,sans-serif;font-weight:600;line-height:1}
.qty-btn:hover{border-color:var(â€“bordeaux2);color:var(â€“bordeaux);background:var(â€“creme2)}
.qty-val{font-weight:600;font-size:0.9rem;min-width:20px;text-align:center}
.del-btn{width:28px;height:28px;border:none;border-radius:8px;background:rgba(220,60,60,0.08);color:#C04040;font-size:0.85rem;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all 0.15s}
.del-btn:hover{background:rgba(220,60,60,0.15)}
.cart-totals{padding:0.8rem 0 0;display:none}
#cart.expanded .cart-totals{display:block}
.cart-total-row{display:flex;justify-content:space-between;font-size:0.85rem;color:var(â€“texte2);padding:0.2rem 0}
.cart-total-row.main{font-weight:700;font-size:1rem;color:var(â€“texte);padding-top:0.5rem;border-top:1px solid var(â€“creme2);margin-top:0.3rem}
.cart-warning{font-size:0.78rem;color:#C04040;text-align:right;margin-top:0.3rem}
.cart-actions{display:none;margin-top:0.8rem}
.btn-validate{width:100%;padding:1rem;border:none;border-radius:var(â€“radius-sm);background:var(â€“bordeaux);color:white;font-family:â€˜DM Sansâ€™,sans-serif;font-weight:600;font-size:0.95rem;cursor:pointer;transition:all 0.25s;margin-bottom:0.6rem;letter-spacing:0.3px}
.btn-validate:hover{background:var(â€“bordeaux2);transform:translateY(-2px);box-shadow:0 8px 24px rgba(92,26,46,0.3)}
.btn-clear{width:100%;padding:0.7rem;border:1.5px solid var(â€“creme3);border-radius:var(â€“radius-sm);background:transparent;color:var(â€“texte2);font-family:â€˜DM Sansâ€™,sans-serif;font-weight:500;font-size:0.85rem;cursor:pointer;transition:all 0.2s}
.btn-clear:hover{border-color:#C04040;color:#C04040}

/* CHECKOUT */
#checkoutOverlay{display:none;position:fixed;inset:0;background:rgba(30,20,16,0.55);z-index:1000;backdrop-filter:blur(4px)}
#checkoutForm{display:none;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:var(â€“blanc);padding:2.5rem;border-radius:var(â€“radius);box-shadow:var(â€“shadow-lg);z-index:1001;max-width:440px;width:92%;max-height:90vh;overflow-y:auto}
#checkoutForm h3{font-size:1.8rem;color:var(â€“bordeaux);margin-bottom:0.4rem}
.checkout-sub{font-size:0.85rem;color:var(â€“texte2);margin-bottom:1.8rem}
#checkoutForm input{width:100%;padding:0.9rem 1.1rem;margin-bottom:0.9rem;border-radius:var(â€“radius-sm);border:1.5px solid var(â€“creme3);font-family:â€˜DM Sansâ€™,sans-serif;font-size:0.95rem;background:var(â€“creme);color:var(â€“texte);transition:border 0.2s}
#checkoutForm input:focus{outline:none;border-color:var(â€“bordeaux2);background:var(â€“blanc)}
#addressSuggestions{background:var(â€“blanc);border:1.5px solid var(â€“creme3);border-radius:var(â€“radius-sm);display:none;max-height:180px;overflow-y:auto;margin-top:-0.6rem;margin-bottom:0.9rem;box-shadow:var(â€“shadow-md)}
.address-suggestion-item{padding:0.75rem 1.1rem;cursor:pointer;border-bottom:1px solid var(â€“creme2);font-size:0.88rem;color:var(â€“texte);transition:background 0.15s}
.address-suggestion-item:hover{background:var(â€“creme)}
.delivery-info-box{background:var(â€“creme);border-radius:var(â€“radius-sm);padding:1rem 1.2rem;margin-bottom:1rem;border:1px solid var(â€“creme2)}
.delivery-info-row{display:flex;justify-content:space-between;font-size:0.88rem;color:var(â€“texte2);padding:0.2rem 0}
.delivery-info-row.total{font-weight:700;font-size:1rem;color:var(â€“texte);padding-top:0.5rem;margin-top:0.3rem;border-top:1px solid var(â€“creme3)}
.btn-confirm{width:100%;padding:1.1rem;border:none;border-radius:var(â€“radius-sm);background:var(â€“bordeaux);color:white;font-family:â€˜DM Sansâ€™,sans-serif;font-weight:600;font-size:1rem;cursor:pointer;transition:all 0.25s;letter-spacing:0.3px}
.btn-confirm:hover{background:var(â€“bordeaux2);transform:translateY(-2px);box-shadow:0 8px 24px rgba(92,26,46,0.3)}

/* TOASTS */
#addedMessage,#errorMessage{position:fixed;top:50%;left:50%;transform:translate(-50%,-60%);padding:1rem 2rem;border-radius:var(â€“radius-sm);font-weight:600;font-size:0.95rem;display:none;z-index:1100;box-shadow:var(â€“shadow-lg);text-align:center;opacity:0;transition:all 0.3s;font-family:â€˜DM Sansâ€™,sans-serif;pointer-events:none}
#addedMessage{background:var(â€“vert);color:white}
#errorMessage{background:#C04040;color:white}
#addedMessage.show,#errorMessage.show{display:block;opacity:1;transform:translate(-50%,-50%)}

/* CONTENT CARDS */
.content-card{background:var(â€“blanc);border-radius:var(â€“radius);border:1.5px solid var(â€“creme2);box-shadow:var(â€“shadow-sm);padding:2.5rem 2rem}
.content-card h2{font-size:2rem;color:var(â€“bordeaux);margin-bottom:1rem}
.content-card p{color:var(â€“texte2);line-height:1.8;font-size:0.95rem;margin-bottom:1rem}
.contact-email{display:inline-flex;align-items:center;gap:0.5rem;background:var(â€“creme);border:1px solid var(â€“creme2);border-radius:var(â€“radius-sm);padding:0.8rem 1.2rem;color:var(â€“bordeaux);font-weight:500;font-size:0.9rem;margin-top:0.5rem}

/* RESPONSIVE */
@media(max-width:600px){
header{padding:1.5rem 1.2rem 2rem}
.header-brand h1{font-size:1.7rem}
.accueil-features{grid-template-columns:1fr}
#categoryList,#commerceList,#productList{grid-template-columns:1fr;gap:1rem}
section{padding-bottom:160px}
#checkoutForm{padding:2rem 1.5rem}
}
@media(min-width:600px){
.accueil-features{grid-template-columns:repeat(3,1fr)}
}
</style>

</head>
<body>

<header>
  <div class="header-top">
    <div class="header-brand">
      <h1>Terroir Sables</h1>
      <div class="subtitle">Les Sables d'Olonne Â· Livraison locale</div>
    </div>
    <div class="header-badge">ğŸš´ 30 min</div>
  </div>
  <div class="header-tagline">Le meilleur du terroir franÃ§ais,<br>livrÃ© Ã  votre porte.</div>
  <div id="cta">
    <button id="orderBtn" onclick="showPage('commander')">Commander maintenant</button>
    <button id="menuBtn" onclick="toggleMenu()">â˜° Menu</button>
  </div>
</header>

<div id="mobileMenuOverlay" onclick="toggleMenu()"></div>
<div id="mobileMenu">
  <div class="menu-header">Terroir Sables</div>
  <a onclick="nav('accueil')"><span class="menu-icon">ğŸ </span> Accueil</a>
  <a onclick="nav('apropos')"><span class="menu-icon">ğŸ·</span> Ã€ propos</a>
  <a onclick="nav('contact')"><span class="menu-icon">âœ‰ï¸</span> Contact</a>
  <a href="inscription.html"><span class="menu-icon">ğŸ¤</span> Nous rejoindre</a>
  <a onclick="nav('mesCommandes')"><span class="menu-icon">ğŸ“¦</span> Mes commandes</a>
  <a id="menuLoginBtn" onclick="openLoginMenu()"><span class="menu-icon">ğŸ‘¤</span> Connexion</a>
  <a id="menuLogoutBtn" onclick="logout()" style="display:none"><span class="menu-icon">ğŸšª</span> DÃ©connexion</a>
</div>

<div id="authBox">
  <h3>Connexion</h3>
  <p class="auth-sub">Connectez-vous pour commander</p>
  <input id="email" type="email" placeholder="Adresse email">
  <input id="password" type="password" placeholder="Mot de passe">
  <button class="auth-btn-primary" onclick="login()">Se connecter</button>
  <button class="auth-btn-secondary" onclick="register()">CrÃ©er un compte</button>
</div>

<section id="accueil">
  <div class="accueil-hero">
    <h2>Bienvenue</h2>
    <p>Vins artisanaux, fromages affinÃ©s, pains fraisâ€¦ SÃ©lectionnÃ©s chez vos artisans locaux des Sables d'Olonne, livrÃ©s en 30 minutes Ã  vÃ©lo.</p>
    <div class="accueil-features">
      <div class="feature-card"><div class="feature-icon">ğŸš´</div><h4>Livraison vÃ©lo</h4><p>Ã‰cologique & rapide</p></div>
      <div class="feature-card"><div class="feature-icon">ğŸª</div><h4>Artisans locaux</h4><p>SÃ©lectionnÃ©s avec soin</p></div>
      <div class="feature-card"><div class="feature-icon">â±ï¸</div><h4>30 minutes</h4><p>Dans un rayon de 5 km</p></div>
    </div>
  </div>
</section>

<section id="apropos" style="display:none">
  <div class="content-card">
    <h2>Ã€ propos</h2>
    <p>Terroir Sables est une plateforme de livraison locale qui valorise les producteurs et artisans des Sables d'Olonne. Notre mission : connecter les meilleurs commerces locaux avec les habitants et touristes de la rÃ©gion.</p>
    <p>Chaque produit est sÃ©lectionnÃ© avec soin. Chaque livraison est assurÃ©e Ã  vÃ©lo, pour rester Ã©co-responsable et rapide.</p>
  </div>
</section>

<section id="contact" style="display:none">
  <div class="content-card">
    <h2>Contact</h2>
    <p>Une question ? Un partenariat ? Contactez-nous.</p>
    <div class="contact-email">ğŸ“§ <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="9efdfbfaecf7fdb0f6ebfbeab0eeecf1def9f3fff7f2b0fdf1f3">[email&#160;protected]</a></div>
  </div>
</section>

<section id="commander" style="display:none">
  <div class="zone-banner">
    <div class="zone-banner-icon">ğŸš´</div>
    <div class="zone-banner-text">
      <strong>Livraison Ã  vÃ©lo</strong> Â· Zone 5 km max<br>
      0â€“3 km : <strong>3,49 â‚¬</strong> Â· 3â€“5 km : <strong>4,49 â‚¬</strong> Â· Panier min. <strong>10 â‚¬</strong>
    </div>
  </div>
  <div class="section-label">CatÃ©gories</div>
  <div id="categoryList"></div>
  <div id="commerceList"></div>
  <div id="productList"></div>
</section>

<section id="mesCommandes" style="display:none">
  <div class="section-label">Mes commandes</div>
  <div id="ordersClient"></div>
</section>

<!-- PANIER -->

<div id="cart">
  <div id="cartHeader">
    <div class="cart-title">ğŸ›’ Panier <span class="cart-count" id="cartCount">0</span></div>
    <span class="cart-toggle" id="toggleCart">â–²</span>
  </div>
  <div id="cartContent"></div>
  <div class="cart-totals" id="cartTotals"></div>
  <div class="cart-actions">
    <button class="btn-validate" onclick="openCheckoutForm()">Valider ma commande â†’</button>
    <button class="btn-clear" onclick="clearCart()">Vider le panier</button>
  </div>
</div>

<!-- CHECKOUT -->

<div id="checkoutOverlay" onclick="closeCheckoutForm()"></div>
<div id="checkoutForm">
  <h3>Livraison</h3>
  <p class="checkout-sub">Renseignez votre adresse de livraison</p>
  <input type="text" id="custName" placeholder="Nom et prÃ©nom">
  <input type="text" id="custPhone" placeholder="TÃ©lÃ©phone">
  <input type="text" id="custAddress" placeholder="Adresse de livraison" autocomplete="off">
  <div id="addressSuggestions"></div>
  <input type="text" id="custAddressExtra" placeholder="BÃ¢timent, Ã©tage, digicodeâ€¦ (optionnel)">
  <div class="delivery-info-box" id="deliveryInfoBox" style="display:none">
    <div class="delivery-info-row"><span>ğŸš´ Livraison</span><span id="deliveryPriceDisplay">â€”</span></div>
    <div class="delivery-info-row"><span>â±ï¸ DÃ©lai estimÃ©</span><span id="deliveryTimeDisplay">â€”</span></div>
    <div class="delivery-info-row total"><span>Total</span><span id="checkoutTotalDisplay">â€”</span></div>
  </div>
  <button class="btn-confirm" onclick="confirmOrder()">Confirmer la commande</button>
</div>

<div id="errorMessage"></div>
<div id="addedMessage">AjoutÃ© au panier âœ“</div>

<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>

const ZONE_MAX_KM=5,TARIF_COURT=3.49,TARIF_LONG=4.49,PANIER_MINIMUM=10;
function getDeliveryPrice(d){if(d>ZONE_MAX_KM)return null;return d<=3?TARIF_COURT:TARIF_LONG}
function getDeliveryTime(d){return d<=3?â€œ~20 minâ€:â€œ~30 minâ€}
function toggleMenu(){const m=document.getElementById(â€œmobileMenuâ€),o=document.getElementById(â€œmobileMenuOverlayâ€),s=m.style.display===â€œblockâ€;m.style.display=s?â€œnoneâ€:â€œblockâ€;o.style.display=s?â€œnoneâ€:â€œblockâ€}
function nav(p){toggleMenu();showPage(p)}
function showPage(p){[â€˜accueilâ€™,â€˜aproposâ€™,â€˜contactâ€™,â€˜commanderâ€™,â€˜mesCommandesâ€™].forEach(id=>{const el=document.getElementById(id);if(el)el.style.display=â€˜noneâ€™});document.getElementById(p).style.display=â€˜blockâ€™;if(p===â€˜mesCommandesâ€™&&window.renderClientOrders)window.renderClientOrders()}
function showMessage(msg){const el=document.getElementById(â€œerrorMessageâ€);el.innerText=msg;el.classList.add(â€œshowâ€);setTimeout(()=>el.classList.remove(â€œshowâ€),2500)}
function showAddedMessage(){const el=document.getElementById(â€œaddedMessageâ€);el.classList.add(â€œshowâ€);setTimeout(()=>el.classList.remove(â€œshowâ€),1500)}

let selectedCommerceId=null;
function getCart(){return JSON.parse(localStorage.getItem(â€œpanierâ€))||[]}
function saveCart(cart){localStorage.setItem(â€œpanierâ€,JSON.stringify(cart));renderCart()}
function clearCart(){localStorage.removeItem(â€œpanierâ€);selectedCommerceId=null;window.currentDeliveryPrice=null;renderCart()}

function addToCart(commerceId,productId,name,price,stock,maxPerDelivery){
if(selectedCommerceId&&selectedCommerceId!==commerceId){showMessage(â€œUn seul commerce Ã  la foisâ€);return}
selectedCommerceId=commerceId;
let cart=getCart();
price=parseFloat(price.toString().replace(â€,â€,â€.â€));
const existing=cart.find(p=>p.productId===productId&&p.commerceId===commerceId);
if(existing){
if(maxPerDelivery>0&&existing.quantity+1>maxPerDelivery){showMessage(`Max ${maxPerDelivery} par commande`);return}
if(existing.quantity>=stock){showMessage(â€œStock insuffisantâ€);return}
existing.quantity+=1;
}else{
if(stock<1){showMessage(â€œIndisponibleâ€);return}
cart.push({commerceId,productId,name,price,quantity:1,stock,maxPerDelivery});
}
saveCart(cart);showAddedMessage();
}

function removeFromCart(productId){let cart=getCart().filter(p=>p.productId!==productId);if(cart.length===0)selectedCommerceId=null;saveCart(cart)}

function updateQuantity(productId,qty){
let cart=getCart();
const i=cart.findIndex(p=>p.productId===productId);
if(i===-1)return;
const item=cart[i];
if(qty>item.stock){showMessage(â€œStock insuffisantâ€);return}
if(qty<=0)cart.splice(i,1);
else{if(item.maxPerDelivery>0&&qty>item.maxPerDelivery){showMessage(`Max ${item.maxPerDelivery}`);return}item.quantity=qty}
if(cart.length===0)selectedCommerceId=null;
saveCart(cart);
}

function renderCart(){
const cartBox=document.getElementById(â€œcartâ€),container=document.getElementById(â€œcartContentâ€),totals=document.getElementById(â€œcartTotalsâ€),countEl=document.getElementById(â€œcartCountâ€),cart=getCart();
const totalItems=cart.reduce((s,i)=>s+i.quantity,0);
if(countEl)countEl.innerText=totalItems;
if(cart.length===0){cartBox.classList.remove(â€œexpandedâ€);container.innerHTML=â€™<p style="color:var(--texte2);font-size:0.9rem;padding:0.5rem 0">Votre panier est vide</p>â€™;totals.innerHTML=â€â€;return}
cartBox.classList.add(â€œexpandedâ€);
container.innerHTML=â€â€;
let itemsTotal=0;
cart.forEach(item=>{
itemsTotal+=item.price*item.quantity;
const div=document.createElement(â€œdivâ€);
div.className=â€œcart-itemâ€;
div.innerHTML=`<div class="cart-item-info"><div class="cart-item-name">${item.name}</div><div class="cart-item-price">${item.price.toFixed(2).replace(".",",")} â‚¬ Ã— ${item.quantity} = <strong>${(item.price*item.quantity).toFixed(2).replace(".",",")} â‚¬</strong></div></div><div class="cart-item-controls"><button class="qty-btn" onclick="updateQuantity('${item.productId}',${item.quantity-1})">âˆ’</button><span class="qty-val">${item.quantity}</span><button class="qty-btn" onclick="updateQuantity('${item.productId}',${item.quantity+1})">+</button><button class="del-btn" onclick="removeFromCart('${item.productId}')">âœ•</button></div>`;
container.appendChild(div);
});
const delivery=window.currentDeliveryPrice,panierOK=itemsTotal>=PANIER_MINIMUM;
totals.innerHTML=`<div class="cart-totals"><div class="cart-total-row"><span>Sous-total</span><span>${itemsTotal.toFixed(2).replace(".",",")} â‚¬</span></div><div class="cart-total-row"><span>Livraison</span><span>${delivery?delivery.toFixed(2).replace(".",",")+" â‚¬":"selon adresse"}</span></div><div class="cart-total-row main"><span>Total estimÃ©</span><span>${(itemsTotal+(delivery||0)).toFixed(2).replace(".",",")} â‚¬</span></div>${!panierOK?`<div class="cart-warning">âš  Minimum ${PANIER_MINIMUM} â‚¬ requis</div>`:""}</div>`;
}

document.addEventListener(â€œDOMContentLoadedâ€,renderCart);
document.getElementById(â€œcartHeaderâ€).onclick=()=>{const cart=document.getElementById(â€œcartâ€),arrow=document.getElementById(â€œtoggleCartâ€);cart.classList.toggle(â€œexpandedâ€);arrow.innerText=cart.classList.contains(â€œexpandedâ€)?â€œâ–¼â€:â€œâ–²â€};

function openCheckoutForm(){const cart=getCart();if(!cart.length){showMessage(â€œPanier videâ€);return}const t=cart.reduce((s,i)=>s+i.price*i.quantity,0);if(t<PANIER_MINIMUM){showMessage(`Minimum ${PANIER_MINIMUM} â‚¬ requis`);return}document.getElementById(â€œcheckoutFormâ€).style.display=â€œblockâ€;document.getElementById(â€œcheckoutOverlayâ€).style.display=â€œblockâ€}
function closeCheckoutForm(){document.getElementById(â€œcheckoutFormâ€).style.display=â€œnoneâ€;document.getElementById(â€œcheckoutOverlayâ€).style.display=â€œnoneâ€}
window.openLoginMenu=function(){toggleMenu();const box=document.getElementById(â€œauthBoxâ€);box.style.display=â€œblockâ€;box.style.opacity=0;box.style.transform=â€œscale(0.95)â€;setTimeout(()=>{box.style.transition=â€œall 0.3s easeâ€;box.style.opacity=1;box.style.transform=â€œscale(1)â€},10)}
</script>

<script type="module">
import{initializeApp}from"https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
import{getFirestore,collection,getDocs,onSnapshot,doc,setDoc,getDoc,addDoc,serverTimestamp,query,where}from"https://www.gstatic.com/firebasejs/12.7.0/firebase-firestore.js";
import{getAuth,createUserWithEmailAndPassword,signInWithEmailAndPassword,onAuthStateChanged}from"https://www.gstatic.com/firebasejs/12.7.0/firebase-auth.js";

const firebaseConfig={apiKey:"AIzaSyB1mljASb5TevqJ1ucDqgXsYQZqEnNxQts",authDomain:"livraison-sablaise.firebaseapp.com",projectId:"livraison-sablaise",storageBucket:"livraison-sablaise.firebasestorage.app",messagingSenderId:"930839535214",appId:"1:930839535214:web:a3235919aa88d066bc507f"};
const app=initializeApp(firebaseConfig),db=getFirestore(app),auth=getAuth(app);
const categoryList=document.getElementById("categoryList"),commerceList=document.getElementById("commerceList"),productList=document.getElementById("productList");
let unsubscribeProducts=null,categoriesSet=new Set(),commerceCategories={};

async function loadCategories(){
  const snapshot=await getDocs(collection(db,"commerces"));
  snapshot.forEach(d=>{const c=d.data(),cat=c.category||"Autres";categoriesSet.add(cat);commerceCategories[d.id]=cat});
  categoryList.innerHTML="";
  [...categoriesSet].sort().forEach(cat=>{
    const div=document.createElement("div");
    div.className="category";div.dataset.opened="false";
    div.innerHTML=`<span>${cat}</span><span class="cat-arrow">â–¶</span>`;
    div.onclick=()=>{
      if(div.dataset.opened==="true"){commerceList.innerHTML="";productList.innerHTML="";div.dataset.opened="false";div.classList.remove("selected");return}
      [...categoryList.children].forEach(c=>{c.dataset.opened="false";c.classList.remove("selected")});
      div.dataset.opened="true";div.classList.add("selected");showCommercesByCategory(cat);
    };
    categoryList.appendChild(div);
  });
}

function showCommercesByCategory(cat){
  productList.innerHTML="";commerceList.innerHTML="";
  getDocs(collection(db,"commerces")).then(snapshot=>{
    snapshot.forEach(docSnap=>{
      if((docSnap.data().category||"Autres")===cat){
        const d=docSnap.data(),div=document.createElement("div");
        div.className="commerce";div.dataset.opened="false";
        div.innerHTML=`<div><div class="commerce-name">${d.name}</div><div class="commerce-tag">${d.category||""}</div></div><span style="color:var(--texte2);font-size:0.85rem">â–¼</span>`;
        div.onclick=()=>{
          if(div.dataset.opened==="true"){productList.innerHTML="";div.dataset.opened="false";div.classList.remove("selected");return}
          [...commerceList.children].forEach(c=>{c.dataset.opened="false";c.classList.remove("selected")});
          div.dataset.opened="true";div.classList.add("selected");showProducts(docSnap.id);
        };
        commerceList.appendChild(div);
      }
    });
  });
}

function showProducts(commerceId){
  productList.innerHTML="";
  if(unsubscribeProducts)unsubscribeProducts();
  unsubscribeProducts=onSnapshot(collection(db,"commerces",commerceId,"produits"),snapshot=>{
    productList.innerHTML="";
    snapshot.forEach(docSnap=>{
      const p=docSnap.data(),stock=p.stock||0,price=parseFloat(p.price.toString().replace(",","."));
      const div=document.createElement("div");
      div.className="product";
      div.innerHTML=`${p.imageUrl?`<img src="${p.imageUrl}" class="productImg" alt="${p.name}">`:""}<div class="product-body"><div class="product-name">${p.name}</div>${p.description?`<div class="product-description">${p.description}</div>`:""}<div class="product-footer"><div class="product-price">${price.toFixed(2).replace(".",",")} <span>â‚¬</span></div><div class="stock-badge">ğŸ“¦ ${stock}</div></div>${p.maxPerDelivery>0?`<div class="max-badge">Max ${p.maxPerDelivery} / commande</div>`:""}</div>`;
      const btn=document.createElement("button");
      btn.className="add-btn";
      btn.innerText=p.available&&stock>0?"Ajouter au panier":"Indisponible";
      btn.disabled=!p.available||stock<1;
      btn.onclick=()=>addToCart(commerceId,docSnap.id,p.name,p.price,stock,p.maxPerDelivery||0);
      div.appendChild(btn);
      productList.appendChild(div);
    });
  });
}

let selectedAddressLatLng=null,addressTimeout=null;
document.getElementById("custAddress").addEventListener("input",e=>{
  const q=e.target.value.trim(),box=document.getElementById("addressSuggestions");
  selectedAddressLatLng=null;clearTimeout(addressTimeout);
  if(q.length<3){box.style.display="none";return}
  addressTimeout=setTimeout(async()=>{
    const url=`https://api.geoapify.com/v1/geocode/autocomplete?text=${encodeURIComponent(q)}&limit=5&lang=fr&filter=countrycode:fr&apiKey=42bb53accb9048248243b21b99a5a18a`;
    const res=await fetch(url),data=await res.json();
    box.innerHTML="";box.style.display="block";
    if(!data.features?.length){box.style.display="none";return}
    data.features.forEach(f=>{
      const div=document.createElement("div");
      div.className="address-suggestion-item";div.innerText=f.properties.formatted;
      div.onclick=async()=>{
        document.getElementById("custAddress").value=f.properties.formatted;
        if(!f.properties.housenumber&&!f.properties.street){showMessage("Adresse prÃ©cise requise");return}
        selectedAddressLatLng={lat:f.geometry.coordinates[1],lng:f.geometry.coordinates[0]};
        const cart=getCart();if(!cart.length)return;
        const snap=await getDoc(doc(db,"commerces",cart[0].commerceId));if(!snap.exists())return;
        const commerce=snap.data(),distance=getDistanceKm(commerce.lat,commerce.lng,selectedAddressLatLng.lat,selectedAddressLatLng.lng);
        if(distance>ZONE_MAX_KM){showMessage(`âŒ Hors zone (${ZONE_MAX_KM} km max)`);document.getElementById("deliveryInfoBox").style.display="none";window.currentDeliveryPrice=null;renderCart();box.style.display="none";return}
        const dp=getDeliveryPrice(distance);window.currentDeliveryPrice=dp;renderCart();
        const itemsTotal=getCart().reduce((s,i)=>s+i.price*i.quantity,0);
        document.getElementById("deliveryInfoBox").style.display="block";
        document.getElementById("deliveryPriceDisplay").innerText=`${dp.toFixed(2).replace(".",",")} â‚¬ (${distance.toFixed(1)} km)`;
        document.getElementById("deliveryTimeDisplay").innerText=getDeliveryTime(distance);
        document.getElementById("checkoutTotalDisplay").innerText=`${(itemsTotal+dp).toFixed(2).replace(".",",")} â‚¬`;
        box.style.display="none";
      };
      box.appendChild(div);
    });
  },300);
});

window.confirmOrder=async function(){
  const user=window.currentUser;
  if(!user){showMessage("Connectez-vous pour commander");return}
  const cart=getCart();if(!cart.length){showMessage("Panier vide");return}
  const itemsTotal=cart.reduce((s,i)=>s+i.price*i.quantity,0);
  if(itemsTotal<PANIER_MINIMUM){showMessage(`Minimum ${PANIER_MINIMUM} â‚¬ requis`);return}
  for(const item of cart){if(item.maxPerDelivery>0&&item.quantity>item.maxPerDelivery){showMessage(`${item.name} : max ${item.maxPerDelivery}`);return}}
  if(!selectedAddressLatLng){showMessage("SÃ©lectionnez une adresse valide");return}
  const snap=await getDoc(doc(db,"commerces",cart[0].commerceId));
  if(!snap.exists()){showMessage("Commerce introuvable");return}
  const commerce=snap.data();
  if(!commerce.lat||!commerce.lng){showMessage("Position commerce non dÃ©finie");return}
  const distance=getDistanceKm(commerce.lat,commerce.lng,selectedAddressLatLng.lat,selectedAddressLatLng.lng);
  if(distance>ZONE_MAX_KM){showMessage(`âŒ Hors zone (${ZONE_MAX_KM} km max)`);return}
  const name=document.getElementById("custName").value.trim(),phone=document.getElementById("custPhone").value.trim(),address=document.getElementById("custAddress").value.trim();
  if(!name||!phone||!address){showMessage("Remplissez tous les champs");return}
  const deliveryPrice=getDeliveryPrice(distance),commission=commerce.commission||15,commissionAmount=parseFloat((itemsTotal*commission/100).toFixed(2)),total=itemsTotal+deliveryPrice;
  try{
    await addDoc(collection(db,"commandes"),{commerceId:cart[0].commerceId,clientId:user.uid,client:{nom:name,tel:phone,adresse:address},items:cart.map(i=>({productId:i.productId,name:i.name,price:i.price,qty:i.quantity})),itemsTotal,deliveryPrice,distanceKm:parseFloat(distance.toFixed(2)),commission,commissionAmount,total,status:"en_attente",createdAt:serverTimestamp()});
    showMessage("âœ… Commande envoyÃ©e !");clearCart();closeCheckoutForm();showPage('mesCommandes');
  }catch(e){showMessage("Erreur : "+e.message)}
};

window.login=async function(){try{await signInWithEmailAndPassword(auth,document.getElementById("email").value,document.getElementById("password").value)}catch(e){showMessage("Email ou mot de passe incorrect")}}
window.register=async function(){const email=document.getElementById("email").value,password=document.getElementById("password").value;try{const cred=await createUserWithEmailAndPassword(auth,email,password);await setDoc(doc(db,"users",cred.user.uid),{email,role:"client",createdAt:new Date()});showMessage("Compte crÃ©Ã© âœ…")}catch(e){showMessage("Erreur inscription")}}
window.logout=function(){auth.signOut().then(()=>showMessage("DÃ©connectÃ© âœ…"))}

onAuthStateChanged(auth,user=>{
  const authBox=document.getElementById("authBox"),loginBtn=document.getElementById("menuLoginBtn"),logoutBtn=document.getElementById("menuLogoutBtn");
  if(user){authBox.style.display="none";window.currentUser=user;loginBtn.style.display="none";logoutBtn.style.display="block"}
  else{window.currentUser=null;loginBtn.style.display="block";logoutBtn.style.display="none"}
});

window.renderClientOrders=function(){
  const container=document.getElementById("ordersClient");
  if(!window.currentUser){container.innerHTML="<p style='color:var(--texte2)'>Connectez-vous pour voir vos commandes</p>";return}
  container.innerHTML="<p style='color:var(--texte2)'>Chargementâ€¦</p>";
  const steps=["en_attente","prete","en_livraison","livree"],labels={en_attente:"â³ En attente",prete:"ğŸŸ  PrÃªte",en_livraison:"ğŸš´ En livraison",livree:"âœ… LivrÃ©e",annulee:"âŒ AnnulÃ©e"};
  onSnapshot(query(collection(db,"commandes"),where("clientId","==",window.currentUser.uid)),snapshot=>{
    container.innerHTML="";
    if(snapshot.empty){container.innerHTML="<p style='color:var(--texte2)'>Aucune commande pour le moment</p>";return}
    snapshot.forEach(docSnap=>{
      const o=docSnap.data(),idx=steps.indexOf(o.status),date=o.createdAt?.toDate?.()?.toLocaleDateString('fr-FR')||"";
      const div=document.createElement("div");
      div.className="order-card";
      div.innerHTML=`<div class="order-card-header"><div class="order-card-title">Commande</div>${date?`<div class="order-date">${date}</div>`:""}</div><div class="order-total-display">ğŸ’° ${o.total?.toFixed(2).replace(".",",")} â‚¬</div><div class="status-bar">${steps.map((s,i)=>`<div class="status-step ${i<=idx?"active":""}"></div>`).join("")}</div><div class="status-label">${labels[o.status]||o.status}</div>`;
      container.appendChild(div);
    });
  });
}

function getDistanceKm(lat1,lng1,lat2,lng2){const R=6371,dLat=(lat2-lat1